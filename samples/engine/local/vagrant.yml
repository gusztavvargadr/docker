component: engine
stack: docker

hostmanager: true

machines:
  bootstrap:
    box: <%= VagrantLinuxServerMachine.defaults['box'] %>
    synced_folders:
      /src/gusztavvargadr/docker:
        source: ../../..
    provisioners:
      shell_machine_configuration:
        inline: <%= "cd /src/gusztavvargadr/docker/samples/images; ./build.sh docker-machine-configuration; docker run -v /data/docker/machine:/data gusztavvargadr/docker-machine-configuration bootstrap,linux,windows engine.docker.vagrant.local #{Dir.pwd}" %>
      shell_server:
        inline: cd /data/docker/machine; ./server.sh bootstrap
  linux:
    provisioners:
      shell_server:
        inline: cd /data/docker/machine; ./server.sh linux
  windows:
    provisioners:
      shell_server:
        inline: cd /data/docker/machine; ./server.ps1 windows
