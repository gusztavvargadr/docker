---
defaults:
  providers:
    core: &provider_core
      memory: 2048
      cpus: 2
  machines:
    core: &machine_core
      providers:
        virtualbox:
          <<: *provider_core
        hyperv:
          <<: *provider_core

environment: swarm.docker
tenant: local

machines:
  bootstrap:
    <<: *machine_core
    box: <%= ENV['VAGRANT_BOX_DOCKER_LINUX'] || 'gusztavvargadr/u16s-dc' %>
    aliases:
      - join
    provisioners:
      shell:
        path: init.sh
        args: eth0
  manager:
    <<: *machine_core
    box: <%= ENV['VAGRANT_BOX_DOCKER_LINUX'] || 'gusztavvargadr/u16s-dc' %>
    # aliases:
    #   - join
    synced_folders:
      ../../..: /src/gusztavvargadr/docker
      .docker: /data/docker
    provisioners:
      shell:
        path: join.sh
        args:
          - join
          - manager
  worker-linux:
    <<: *machine_core
    box: <%= ENV['VAGRANT_BOX_DOCKER_LINUX'] || 'gusztavvargadr/u16s-dc' %>
    provisioners:
      shell:
        path: join.sh
        args:
          - join
          - worker
  worker-windows:
    <<: *machine_core
    box: <%= ENV['VAGRANT_BOX_DOCKER_WINDOWS'] || 'gusztavvargadr/w16sc-de' %>
    provisioners:
      shell:
        path: join.ps1
        args:
          - join
          - worker
